@using AHSECO.CCL.FRONTEND.Core;

@{
    ViewBag.Title = "Registro Instalación Técnica";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var numReq = VariableSesion.getCadena("NumReq");
    var codEstado = VariableSesion.getCadena("CodEstado");
    var IdWorkFlow = VariableSesion.getCadena("IdWorkFlow");
    var tipoProceso = VariableSesion.getCadena("TipoProceso");

    var visualizar = false;

    if(tipoProceso != "")
    {
        visualizar = true;
    };

}

<input hidden id="numeroReq" value="@numReq" />
<input hidden id="codigoWorkflow" value="@IdWorkFlow" />
<input hidden id="estadoReq" value="@codEstado" />
<input hidden id="tipoproceso" value="@tipoProceso"/>

<div class="container-fluid">
    <h4><i class="fa fa-wrench" aria-hidden="true"></i> @ViewBag.Title</h4>
    <div class="box-inner">
        <div class="box-header well" data-original-title="">
            <div style="display: flex;justify-content: space-between;">
                @if (numReq != "")
                {
                    var numReqFormateado = ("000000" + numReq);

                    numReqFormateado = numReqFormateado.Substring((numReqFormateado.Length) - 6, numReqFormateado.Length - ((numReqFormateado.Length) - 6));

                    <h2>N&uacute;mero de Requerimiento: @numReqFormateado</h2> <!--- Aquí tendremos que controlar-->

                    <div class="text-right">
                        <!--- Aquí tendremos que controlar-->
                        <label>ESTADO: <span id="spanEstadoSol"></span></label>
                    </div>
                }

            </div>
        </div>
        <div class="box-content">
            <div class="container-fluid" style="margin-right: 15px;">
                <form id="formRequerimiento">
                    <input type="hidden" id="contador" value="0" />
                    <input type="hidden" id="contadordoc" value="0" />
                    <div class="row container-fluid">
                        <div class="col-md-4 col-sm-12">
                            <label for="txtSolVenta">Solicitud de Venta: </label>
                            <div class="form-group">
                                <div @(visualizar ? "disabled" : "") class="input-group input-group-sm date">
                                    <input type="text" class="form-control input-sm" id="txtSolVenta" value="" placeholder="---Seleccionar Solicitud---" aria-describedby="sizing-addon3" disabled="disabled" />
                                    <span style="cursor:pointer" class="input-group-addon input-sm" id="searchSolVenta" title="Buscar Solicitud" data-toggle="modal" data-target="#modalSolicitud">
                                        <i class="fa fa-search"></i>
                                    </span>
                                    <input type="hidden" id="txtCodSolicitud" value="" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <input hidden id="hdnCodEmpresa" value="" />
                            <label for="txtEmpresa">Empresa: </label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtEmpresa" value="">
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label for="cmbTipVenta">Tip. Venta:</label>
                            <div class="input-group col-sm-12 col-md-12 col-lg-12">
                                <select disabled aria-hide="false" id="cmbTipVenta" type="text" class="input form-control input-sm">
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row container-fluid" style="background-color: #0079ef24; border-radius: 10px;">
                        <div class="col-md-4 col-sm-12">
                            <label for="txtRuc">R.U.C:</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtRuc" value="">
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label for="txtNomEmpresa">Razón Social(Cliente):</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtNomEmpresa" value="">
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label for="txtUbigeo">Ubigeo: </label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtUbigeo" value="">
                            </div>
                        </div>
                    </div>
                    <div class="row container-fluid">
                        <div class="col-md-4 col-sm-12">
                            <label for="txtAsesor">Representante de Ventas:</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtAsesor" value="">
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label for="cmbDestino">Destino :</label>
                            <div class="form-group">
                                <select multiple disabled class="form-control select2 input-sm" style="width:100%;" id="cmbDestino" data-selected="">
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label for="dateSolicitud">Fecha M&aacute;xima: </label>
                            <div class="input-group date">
                                <input disabled type="text" class="form-control input-sm" id="dateSolicitud" aria-describedby="sizing-addon3" placeholder="dd/mm/aaaa" maxlength="10">
                                <span class="input-group-addon input-sm" id="openRegdateSolicitud">
                                    <i class="fa fa-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="row container-fluid" id="rowDocsProc" style="display:none">
                        <div class="col-md-4 col-sm-12" id="colProceso">
                            <label for="txtProceso">N° Proceso:</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtProceso" value="">
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12" id="coltipProceso">
                            <label for="txtProceso">N° Proceso:</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtTipProceso" value=""/>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12" id="colContrato" style="display:none">
                            <label for="txtContrato">N° Contrato:</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtContrato" value="">
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12" id="colOrdenCompra" style="display:none">
                            <label for="txtOrdCompra">Orden de Compra:</label>
                            <div class="form-group">
                                <input disabled type="text" class="form-control input-sm" id="txtOrdCompra" value="">
                            </div>
                        </div>
                    </div>
                    <br />
                    <div class="row container-fluid">
                        <div class="text-right">
                            @if (numReq == "")
                            {
                                <button class="btn btn-default btn-sm" type="button" data-dismiss="modal" id="btnRegistrarReq" tabindex="14"><i class="fa fa-save" aria-hidden="true"></i>&nbsp;Registrar</button>
                            }
                            else if (numReq != "")
                            {
                                if(tipoProceso == "U")
                                {               
                                <button class="btn btn-default btn-sm" type="button" data-dismiss="modal" id="btnEditarReq" tabindex="14"><i class="fa fa-pencil" aria-hidden="true"></i>&nbsp;Editar Requerimiento</button>
                                }
                            }
                            <button class="btn btn-info btn-sm" type="button" data-dismiss="modal" id="btnRegresar" tabindex="14"><i class="fa fa-undo" aria-hidden="true"></i>&nbsp;Regresar</button>
                        </div>
                    </div>
                </form>
                <ul class="nav nav-tabs" style="padding-top: 5px;">
                    <li class="" id="tabDetalleSolicitud">
                        <a href="#navDetalleSolicitud" data-toggle="tab" style="font-weight: bold; color: black;" tabindex="20"><i class="fa fa-info-circle" aria-hidden="true"></i> Detalle</a>
                    </li>
                    <li class="" id="tabAdjuntos">
                        <a href="#navDocumentos" data-toggle="tab" style="font-weight: bold; color: black;" tabindex="20"><i class="fa fa-file-text" aria-hidden="true"></i> Adjunto de Documentos</a>
                    </li>
                    <li class="" id="tabObservaciones">
                        <a href="#navObservaciones" data-toggle="tab" style="font-weight: bold; color: black;" tabindex="21"><i class="fa fa-exclamation" aria-hidden="true"></i> Observaciones</a>
                    </li>
                    <li class="" id="tabContacto">
                        <a href="#navContactoDetalle" data-toggle="tab" style="font-weight:bold; color: black;" tabindex="22"><i class="fa fa-address-card-o" aria-hidden="true"></i> Info. Contacto</a>
                    </li>
                </ul>
                <div class="tab-content" style="padding-top: 5px;">
                    <div id="navDetalleSolicitud" class="tab-pane fade in active">
                        <div class="panel-group" id="accordion7401210" role="tablist" aria-multiselectable="false">
                            <div class="box-content">
                                <div class="table-responsive">
                                    <table id="tblMainProducts" class="table table-hover table-condensed table-striped table-bordered" width="100%">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center; width: 5%">Id</th>
                                                <th style="text-align:center; width: 10%">Descripci&oacute;n</th>
                                                <th style="text-align:center; width: 10%">Marca</th>
                                                <th style="text-align:center; width: 5%">Modelo</th>
                                                <th style="text-align:center; width: 5%">Cantidad</th>
                                                <th style="text-align:center; width: 5%">Calibraci&oacute;n</th>
                                                <th style="text-align:center; width: 5%">Llave en Mano</th>
                                                <th style="text-align:center; width: 5%">Requiere Placa</th>
                                                <th style="text-align:center; width: 5%">N&uacute;mero Fianza</th>
                                                <th style="text-align:center; width: 5%">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbodyProductos">
                                            <tr id="NoExisteProductos">
                                                <td colspan="10"><center>No hay data que mostrar</center></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                @if (numReq != "")
                                {
                                    if(tipoProceso != "V")
                                    {                       
                                    <div class="row container-fluid">
                                        <div class="text-right">
                                            @if (codEstado == "STREG")
                                            {
                                                <button class="btn btn-default btn-sm" type="button" data-dismiss="modal" id="btnProcesoInst" tabindex="14"><i class="fa fa-cog" aria-hidden="true"></i>&nbsp;Cambiar a Estado: En Proceso de Instalación</button>
                                            }
                                            @if (codEstado == "STEPI")
                                            {
                                                <button class="btn btn-default btn-sm" type="button" id="btnFinalizarReq"><i class="fa fa-save" aria-hidden="true"></i>&nbsp;Finalizar Requerimiento</button>
                                            }
                                        </div>
                                    </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <div id="navDocumentos" class="tab-pane fade">
                        @{
                            Html.RenderPartial("~/Views/Modelos/_Documentos.cshtml");
                        }
                    </div>
                    <div id="navObservaciones" class="tab-pane fade">
                        @{
                            Html.RenderPartial("~/Views/Modelos/_Observaciones.cshtml");
                        }
                    </div>
                    <div id="navContactoDetalle" class="tab-pane fade">
                        <div class="panel-group" id="accordion7401210" role="tablist" aria-multiselectable="false">
                            <div class="box-content">
                                <div class="row container-fluid">
                                    <div class="col-md-6 col-sm-12">
                                        <label for="txtNomContacto">Nombre de Contacto:</label>
                                        <div class="form-group">
                                            <input placeholder="Nombre de Contacto" disabled type="text" class="form-control input-sm" id="txtNomContacto">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <label for="txtTelefContacto">Tel&eacute;fono de Contacto:</label>
                                        <div class="form-group">
                                            <input placeholder="Teléfono de Contacto" disabled type="text" class="form-control input-sm" id="txtTelefContacto">
                                        </div>
                                    </div>
                                </div>
                                <div class="row container-fluid">
                                    <div class="col-md-6 col-sm-12">
                                        <label for="txtEstablecimientoCont">Establecimiento:</label>
                                        <div class="form-group">
                                            <input placeholder="Establecimiento" disabled type="text" class="form-control input-sm" id="txtEstablecimientoCont">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <label for="txtCargoContacto">Cargo de Contacto:</label>
                                        <div class="form-group">
                                            <input placeholder="Cargo de Contacto" disabled type="text" class="form-control input-sm" id="txtCargoContacto">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@{
    Html.RenderPartial("~/Views/Modelos/_Modales.cshtml");
}



<div class="modal fade" id="modalAsignacion" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    @{
        Html.RenderPartial("_AsignacionTecnico");
    }
</div>


<div class="modal fade" id="modalSolicitud" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    @{
        Html.RenderPartial("_BusquedaSolicitud");
    }
</div>


<div class="modal fade" id="modalBusquedaTecnico" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    @{
        Html.RenderPartial("_BuscarTecnico");
    }
</div>

<div class="modal fade" id="modalZona" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    @{ 
        Html.RenderPartial("_Ubigeo");
    }
</div>

<div class="modal fade" id="modalDetalleInstalacion" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    @{ 
        Html.RenderPartial("_DetalleInstalacionTecnica");
    }
</div>

<div class="modal fade" id="modalElementosDeProducto" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">>
    @{ 
        Html.RenderPartial("_ElementosDeProducto");
    }
</div>


@section scripts{
    <script type="text/javascript" src="~/resources/js/app/ServicioTecnico/BandejaInstalacionTecnica/registroInstalacionTecnica.js"></script>
}
